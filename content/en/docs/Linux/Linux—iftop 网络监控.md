---
title: Linux iftop 网络监控
date: 2024-01-03
author: LMingJian
---

## 1.iftop 命令

iftop 是 Linux 中的一个网卡实时流量监控工具，可以监控指定网卡的实时流量、端口连接信息、反向解析 IP 等，还可以精确显示本机网络流量及网络内各主机和本机相互通信的流量集合。

## 2.安装

```shell
yum install -y epel-release
yum install -y iftop 
```

## 3.使用

```shell
iftop -P -i eth0
```

参数 -i 监控 eth0 网卡的流量，-P 显示主机以及端口信息。

![](/images/drawingbed/img/202401031117271.png)

在 iftop 的输出中，最上面的一行，表示的是流量刻度，用于显示网卡带宽流量。

在 iftop 输出的中央主体部分，分为左、中、右三列。左列和中列，记录了哪些 IP 或主机正在和本机的网络进行连接。其中，=> 代表发送数据，<= 代表接收数据，通过这个指示箭头可以很清晰地知道两个 IP 之间的通信情况。最右列分别表示外部 IP 连接到本机 2 秒内、10 秒内和 40 秒内的平均流量值。另外，这个部分还有一个流量图形条来对流量大小动态展示，以顶部的流量刻度为基准。

在 iftop 输出的最下面分别展示 TX 发送数据的总量，RX 接收数据的总量，TOTAL 发送和接收的全部流量。与这三行对应的有三列，其中 cum 表示从运行 iftop 到目前的发送、接收和总数据流量。peak 表示发送、接收以及总的流量峰值。rates 列表示过去 2s、10s、40s 的平均流量值。

## 4.交互使用

在 iftop 的实时监控界面中，还可以对输出结果进行交互式操作，用于对输出信息进行整理和过滤。

在实时监控时，按下 h 即可进入交互选项界面。在交互界面中，可按下以下参数进行信息整理。

```
参数      含义
P        通过此键可切换暂停/继续显示
h        通过此键可在交互参数界面/状态输出界面之间来回切换
b        通过此键可切换是否显示平均流量图形条
B        通过此键可切换显示2秒、10秒、40秒内的平均流量
T        通过此键可切换是否显示每个连接的总流量
j/k      按j键或k键可以向上或向下滚动屏幕显示当前的连接信息
l        通过此键可打开iftop输出过滤功能，比如输入要显示的IP，按回车后，屏幕就只显示与这个IP相关的流量信息
L        通过此键可切换显示流量刻度范围，刻度不同，流量图形条会跟着变化
q        通过此键可退出iftop流量监控界面
n        通过此键可使iftop输出结果以IP或主机名的方式显示
s        通过此键可切换是否显示源主机信息
d        通过此键可切换是否显示远端目标主机信息
t        通过此键可切换iftop显示格式，连续按此键可依次显示：以两行显示发送接收流量、以一行显示发送接收流量、只显示发送流量/接收流量
N        通过此键可切换显示端口号/端口号对应服务名称
S        通过此键可切换是否显示本地源主机的端口信息
D        通过此键可切换是否显示远端目标主机的端口信息
p        通过此键可切换是否显示端口信息
1/2/3    根据最近 2 秒、10 秒、40 秒的平均网络流量排序
<        通过此键可根据左边的本地主机名或IP地址进行排序
>        通过此键可根据远端目标主机的主机名或IP地址进行排序
o        通过此键可切换是否固定显示当前的连接
```

## 5.参数

```
-i 指定需要检测的网卡，如：# iftop -i eth1
-B 将输出以 byte 为单位显示，默认是 bit
-n 将输出的主机信息都通过 IP 显示，不进行 DNS 解析 
-N 只显示连接端口号，不显示端口对应的服务名称
-F 显示特定网段的网卡进出流量，如：# iftop -F 192.168.85.0/24
-h 帮助，显示参数信息
-p 以混杂模式运行 iftop，此时 iftop 可以用作网络嗅探器
-P 显示主机以及端口信息
-m 设置输出界面中最上面的流量刻度最大值，流量刻度分 5 个大段显示，如：# iftop -m 100M
-f 使用筛选码选择数据包来计数，如：# iftop -f filter code
-b 不显示流量图形条
-c 指定可选的配置文件，如：# iftop -c config file
-t 使用不带 ncurses 的文本界面，以下参数只能与 -t 一起使用
   -s num num 秒后打印一次文本输出并退出，-t -s 60 组合使用，表示取 60 秒内的网络流量输出到终端
   -L num 打印的行数
-f 参数支持 tcpdump 的语法，可以使用各种过滤条件
```

{{< details "参考文件" >}} 
1：[ Linux - CentOs7 监控 ](https://blog.csdn.net/u012374381/article/details/129836203)
2：[ Linux 网络流量监控利器 iftop ](https://blog.csdn.net/qq_40907977/article/details/115066452)
{{< /details >}}
---
title: 01计算机系统构成及硬件基础知识
date: 2023-04-10
author: LM
---

## 冯·诺伊曼型计算机

- 冯·诺伊曼型计算机是以存储程序控制为概念的一种计算机模型。
- 存储程序控制是指程序和数据事先存放在存储器中，当启动工作时，再自动高速的从存储器中取出并执行。
- 冯·诺伊曼型计算机由运算器，控制器，存储器，输入装置，输出装置 5 大基本部件组成。

## 硬件和软件

- 一个完整的计算机系统由硬件系统和软件系统两部分组成。
- 硬件是计算机的实体，是计算机实现其功能的物质基础。
- 软件是指挥计算机运行的程序集，如操作系统，网络系统等都属于软件，没有安装任何软件的计算机称为裸机。

## 计算机三大核心部件

CPU、存储器、输入 / 输出设备（ I/O 设备 ），三种组件间由总线进行连接。

## CPU 的组成

CPU 硬件上主要由运算器和控制器，以及用于存储数据的存储器和传输数据的总线组成。

CPU 逻辑上由控制单元、运算单元和存储单元组成，这三部分由 CPU 内部总线进行连接。

运算器主要由以下部件组成：

- **算术逻辑单元 ALU**：CPU 的执行单元，同时也是 CPU 的核心组成部分，一个由与门和或门构成的算术逻辑单元。其主要功能是进行整数的二位元的算术运算，如加减乘(不包括整数除法)。
- **累加器 AC**：当运算器的算术逻辑单元执行算术或逻辑运算时，为 ALU 提供一个工作区，暂时存放运算结果信息。
- **数据缓冲寄存器 DR**：作为 CPU 和内存及外部设备间信息传送的中转站，用来暂时存放由内存读出或准备存入的指令或数据。
- **状态寄存器 PSW**：保存由算术指令和逻辑指令运行结果所建立的各种条件码内容，如运算结果的进位标志、溢出标志，为零标志、为负标志等。
- **通用寄存器组**：用于传送和暂存数据，也可参与算术逻辑运算，并保存运算结果。通用寄存器的长度取决于机器字长。

控制器通常由以下部件组成：

- **程序计数器 PC**：又称指令计数器，其总是保持将要执行的下一条指令的地址。在程序开始执行前，必须将它的起始地址，即程序第一条指令所在的内存地址送入 PC。大部分情况下，所有指令的地址码都需要先送入 PC，**程序员通过访问 PC 来控制程序执行过程**。
- **指令寄存器 IR**：用来保存当前正在执行的指令，**其位数取决于指令的长度**。当执行一条指令时，CPU 需要先把它从内存取到数据缓冲寄存器，然后再传送到指令寄存器。**指令寄存器对用户来说是完全透明的**，用户可以随时检查当前执行的指令。
- **指令译码器 ID**：分析和执行当前指令的部件。为了执行给定的指令，必须对操作码进行测试，以便识别所要求的操作。操作码一经译码后，即可向操作控制器发出具体的操作的信号。
- **操作控制器 OC**：根据指令操作码和时序信号，产生各种操作控制信号，以便正确地建立数据通路，从而完成取指令和执行指令的控制。CPU 内的每个部件间需要 OC 来控制信息传输，完成诸如信息从什么地方开始发送，中间经过哪个寄存器，最后传到哪个寄存器等操作。
- **时序节拍发生器**：CPU 中的一个时钟设备，使计算机可以准确、迅速、有条不紊地工作。操作控制器利用定时脉冲的顺序和不同的脉冲间隔，有条理、有节奏地指挥机器的动作，规定在这个脉冲到来时做什么，在那个脉冲到来时又做什么，给计算机各部分提供工作所需的时间标志。

存储器主要由以下部件组成：

- **寄存器组**：CPU 中暂时存放数据的地方，里面保存着那些等待处理的数据，或已经处理过的数据，CPU 访问寄存器所用的时间要比访问主存的时间短。采用寄存器组，可以减少 CPU 访问内存的次数，从而提高了 CPU 的工作速度。但因芯片面积和集成度所限，寄存器组的容量不可能很大。
- **高速缓冲存储器**：存在于主存与 CPU 之间的一级存储器，与主存间的信息传送通过硬件自动进行，容量比较小但速度比主存高得多，接近于 CPU 的速度，通常用来辅助寄存器组工作。

## CPU 的多级时序系统

机器周期、节拍（状态）组成了多级时序系统。

一个指令周期包含若干个机器周期，一个机器周期包含若干个时钟周期。

- **指令周期**：CPU 每取出并执行一条指令所需的全部时间叫指令周期。
- **机器周期/总线周期**：一般一条完整的指令包括：取指周期、间址周期、执行周期、中断周期。机器周期就是 CPU 指令执行过程中的一个基准事件。由于 CPU内部的操作速度较快，CPU 访存的操作时间较长，因此通常以访问一次存储器的时间定为机器周期。又由于不论执行什么指令，都需要访问存储器取出指令，因此在存储字长等于指令字长的前提下，取指周期也可看作机器周期。机器周期取决于指令的功能和器件的速度。
- **时钟周期/震荡周期**：在一个机器周期可完成若干个微操作，每个微操作需要一定的时间，可用时钟信号来控制每一个微操作命令。用时钟信号控制节拍发生器，就可产生节拍。每个节拍的宽度正好对应一个时钟周期。时钟周期是控制计算机操作的最小时间单位。

一个指令周期包含的机器周期个数与指令所要求的动作有关，如单操作数指令，只需要一个取操作数周期，而双操作数指令需要两个取操作数周期。实际上，不同的指令可以有不同的机器周期个数，而每个机器周期又可包含不同的时钟脉冲个数。

## 存储器

- **存储器的组成**：包括存储体，地址译码器，读写控制器，地址总线，数据总线。
- **主存**：由中央处理器直接随机存取指令和数据的存储器。
- **外存**：磁盘，磁带等外设。
- **存储周期**：存储器执行一次完整的存取操作所需的时间。

## 存储器的类型

按寻址/存取方式可以分类为：

- **随机存储器 RAM**：任何存储单元的内容都能被随机存取，且存取时间和存储单元的物理位置无关。
- **只读存储器 ROM**：存储的内容是固定不变的，只能读出而不能写入。
- **顺序存取存储器 SAM**：只能按某种顺序来存取，存取时间与存储单元的物理位置有关。
- **直接存取存储器 DMA**：数据可以不经过 CPU 的处理就直接在存储器或输入输出设备之间进行传输。
- **相联存储器**：不依靠地址，可以按照内容检索到存储位置进行读写。

按在计算机系统中的作用分类为：

- **主存储器（内存）**：用于存放活动的程序和数据，其速度高、容量较小、每位价位高。主存属于随机存取器。
- **辅助存储器（外存储器）**：主要用于存放不活跃的程序和数据，其速度慢、容量大、每位价位低。
- **缓冲存储器**：主要在两个不同工作速度的部件起缓冲作用。

按功能/容量/速度/所在位置可以分类为：

- **寄存器**：寄存器是 CPU 内部用来存放数据的一些小型存储区域，用来暂时存放参与运算的数据和运算结果，拥有最快的存取速度。
- **高速缓存 Cache**：介于 CPU 和主存储器之间的高速小容量存储器。它和主存储器一起构成一级的存储器，容量比较小但速度比主存快，接近于 CPU 的速度。通常用来缓存一些常用数据，在程序运行时，Cache 和主存间的全部功能都由硬件自动完成。
- **内存储器**：用于存放 CPU 中的运算数据，以及与硬盘等外部存储器交换的数据，是外存与 CPU 进行沟通的桥梁。计算机中所有程序的运行都在内存中进行。
- **外存储器**：外储存器是指除计算机内存及 CPU 缓存以外的储存器，此类储存器一般断电后仍然能保存数据。常见的外存储器有硬盘、软盘、光盘、U 盘等。

## 存储器的速度比较

CPU 内部寄存器 > 高速缓存 Cache > 主存 > 大容量磁盘

## 虚拟存储器体系

在具有主存辅存层次结构存储器的计算机系统中，自动实现部分装入和部分替换功能，能从逻辑上为用户提供一个比物理贮存容量大得多，可寻址的主存储器。

虚拟存储区的容量与物理主存大小无关，而受限于计算机的地址结构和可用磁盘容量。

虚拟存储器的基本思路是：作业提交时，先全部进入辅助存储器，作业投入运行时，不把作业的全部信息同时装入主存储器，而是将其中当前使用部分先装入主存储器，其余暂时不用的部分先存放在作为主存扩充的辅助存储器中，待用到这些信息时，再由系统自动把它们装入到主存储器中。

## 外存（磁盘）

磁盘是计算机主要的存储介质，可以存储大量的二进制数据，并且断电后也能保持数据不丢失。

磁盘由以下部件组成：

- **盘片**：一个磁盘由多个盘片叠加而成。
- **盘面**：盘片的表面涂有磁性物质，这些磁性物质用来记录二进制数据。盘片正反两面都可涂上磁性物质，因此一个盘片可能会有两个盘面。
- **磁道**：每个盘片被划分为一个个磁道（圆的周长）。
- **扇区**：每个磁道又划分为一个个扇区。其中，最内侧磁道上的扇区面积最小，因此数据密度最大（圆的面积）。
- **柱面**：每个盘面对应一个磁头。所有的磁头都是连在同一个磁臂上的，因此所有磁头只能共进退。所有盘面中相对位置相同的磁道组成柱面。

磁盘的存储容量 C  = 扇区总数 x 每个扇区存储的字节数（物理块大小）

## 内存（主存）

内存（主存）是计算机的重要部件，结构上为随机存储器 RAM。它用于暂时存放 CPU 中的运算数据，以及与硬盘等外部存储器交换的数据。它是外存与 CPU 进行沟通的桥梁，计算机中所有程序的运行都在内存中进行，只要计算机开始运行，操作系统就会把需要运算的数据从内存调到 CPU 中进行运算，当运算完成，再由 CPU 将结果传送出来。内存性能的强弱影响计算机整体发挥的水平。

## 内存的物理表现

内存由多个内存芯片、SPD 芯片（串行存在检测芯片）、少量电阻以及 PCB 板（印制电路板）组成。

内存的存储容量由内存芯片的个数和单个芯片的容量决定。

## 内存容量的计算

问题：内存按字节编址从 A5000H 到 DCFFFH，计算内存容量？

解：DCFFF - A5000 + 1=38000H，将 38000H 换算为二进制为：11 1000 00-00 0000 0000 = 1110 0000  X 2^10 = 224 KB，即内存容量224KB。

- 16 进制计算中，可将 A 看作 10，B 看作 11，C 看作 12，以此类推，逐位计算。
- 2 进制计算中，1-00 0000 0000 = 1 X 2^10 = 1 KB，10 个 0 等于 2^10

## 内存芯片数量的计算

问题：内存按字节编址，地址为 0B4000H 至 0DBFFFH，若用存储容量为 32K*8bit 的存储器芯片构成内存，至少需要多少片？

解：首先由 0DBFFFH - 0B4000H + 1 算得内存容量为 028000H B，即 160 KB。然后由于单个内存芯片容量为 32 KB，因此需要内存芯片个数 160 / 32 = 5，即该内存条由 5 个 32 KB 的内存芯片构成。

## 内存地址的计算

- 主存地址位数 = 主存容量（2^n）的幂 = n

练习5 如果主存容量为 16MB 字节，且按字节编址，则表示该主存地址至少需要____位。

A.16      B.20        C.24         D.32

答案：C，16 MB = 16 * 1024 * 1024 b = 2^(4+10+10) = 2^24

- 主存地址位数 = 区号 + 组号 + 组内块号（每组字块数量 2^y 的幂 y） + 块内地址号（字块容量 2^x 的幂 x）

练习6 容量为 64 块的 Cache 采用组相联方式映像，字块大小为 128 个字，每 4 块为一组。若主存容量为 4096 块，且以字编址，那么主存地址应为____位，主存区号应为____位。

- 字块大小为 128 (2^7) 个字，则块内地址号：7
- 每 4 (2^2) 块一组，则组内块号：2
- Cache 容量为 64 块，每 4 块一组，则可以分为 16 (2^4) 组，则组号：4
- 主存容量 4096 * 128 = 2^19，则区号：19-4-2-7 = 6
- 答案：主存地址 19，主存区号 6

## 高位存储芯片的合成

在存储器（如寄存器，内存）中，容量的最小单位是位 bit，只能存放一位二进制数，即 0 或 1。而常用的容量单位是字节 Byte，8个 bit 为一个字节 B。容量一般用 KB，MB，GB 来表示，它们之间的关系相差 1024 倍。一个存储器通常由多个芯片组成。

芯片的容量通常使用 1K X 8 位 这样的格式来表示，1K X 8 位 表示这个芯片的位数是 8 位( 可连接 8 位地址线 ) ，长度是 1K，容量是 8Kb。又比如，2K X 4位 的芯片宽度是 4 位，长度是 2K，那么容量就是 8Kb，按字节计算就是 1KB。

有时会使用多个低位的芯片组成一个高位存储器，比如使用多个 2K X 4位 的芯片组成一个 16K X 8 位的存储器。此时，通常需要将两片 2K X 4 位 的并联成一个 2K X 8 位的矩阵组，使得位数满足后，再计算需要芯片组 16K / 2K = 8 组，最后得到总共需要的芯片数 2 X 8 = 16 个。若从地址单元从 0000H 开始，则第一个 2K = 2^11  = 0800H 芯片的地址范围是 0000H 至 07FFH，第二个是 0800H 到 0FFFH ......

## 总线（Bus）

总线（Bus）是计算机CPU，内存，输入输出等部件间传递信息的共用通道，是由导线组成的传输线束，按功能和规范分为以下 3 种：

- **片总线（C-Bus）**：又称元件级总线，是各种不同的芯片连接通信的信息传输通路，通常出现在CPU内
- **内总线（I-Bus）**：又称系统总线和板级总线，是系统中各模块的信息传输通路，通常如CPU模块与存储器模块间的传输通路
- **外总线（E-Bus）**：又称通信总线，是计算机系统与系统外设备连接的信息传输通路

## 系统总线

系统总线按功能可分为：

- **数据总线 DB**：双向三态形式的总线。双向是指既可以把 CPU 的数据传出，也可以将其他部件的数据传入 CPU。CPU 与其他部件通过数据总线来交换数据。三态是指 -1，0，1。需要注意的是，数据总线的位数是微机的一个重要指标，数据总线宽度越大，单位时间内进出 CPU 的数据越多，系统运算速度越快。**数据总线位数通常与处理器的字长一致**。
- **地址总线 AB**：单向三态形式的总线。由于地址只能从 CPU 传向外部存储器，所以地址总线总是单向的。其位数决定 CPU 可以直接寻址的内存空间大小。若地址总线为 n 位，则寻址能力，即内存容量为 2^n，以字节为单位，则为 2^n B，**比如内存容量为 32GB ( 2^32 )的系统，其地址总线 32 位**。
- **控制总线 CB**：用来传送控制信号和时序信号。控制总线的传送方向由具体的控制信号而定，一般都是双向的。控制总线的位数根据系统 CPU 而定。

系统总线按传输数据的方式可分为：

- **串行总线**：二进制数据逐位通过一条数据线进行传递。
- **并行总线**：数据线通常超过两根，并行传递数据。

系统总线按时钟信号能否单独提取分为：

- **同步总线**：时钟信号独立于数据。
- **异步总线**：时钟信号从数据中获取。

## 总线复用

顾名思义就是一条总线实现多种功能，例如在不同时段中利用总线上同一信号线传输不同信号，采用这种方式来**减少总线中信号线的数量，提高总线的利用率**。

## 寻址

寻址就是处理器根据指令中给出的地址信息在主存中寻找有效地址的方式，是确定本条指令的数据地址以及下一条要执行的指令地址的方法。

- **立即数寻址**：获取操作数最快的寻址方式，操作数直接存放到指令中，紧跟操作码之后，如 MOV  AX，2435H
- **寄存器寻址**：操作数存放在 CPU 的内存寄存器中，可在指令中指出寄存器名调用，如 MOV  AX，BX
- **存储器寻址**：操作数存放在存储器 RAM 某个单元中，根据操作数地址不同，又分为以下 5 种方式：
  - *直接寻址*：指令给出的地址就是操作数的有效地址，如 MOV  AX，[2000H]
  - *寄存器间接寻址*：操作数的地址存放在寄存器，如 MOV  AX，[BX]
  - *寄存器相对寻址*：以指定的寄存器内容，加上指令中给出的位移量，并以一个段寄存器位基准作为操作数地址。指定的寄存器一般为基址寄存器或变址寄存器，如 MOV  AX，COUNT[SI]
  - *基址加变址寻址*：把基址寄存器BX和BP的内容加上变址寄存器SI和DI的内容，如 MOV  AX，[BX] [DI]
  - *相对基址加变址寻址*：在基址加变址寻址的基础上增加一个位移量，如 MOV  AX，MASK[BX] [SI]

## 寻址能力（空间）

一般来说，地址总线决定寻址能力，若地址总线为 n 位，则寻址能力为 2^n，以字节为单位，则为 2^n B。例如：地址总线宽度为 24 位，则其寻址空间为 2^24 = 2^4 MB = 16 MB

## 内存与 I/O 接口的编址方式

- **统一编址方法**：内存地址和接口地址在一个公共的地址空间。其中一部分划给接口使用，其余地址给内存单元使用，内存单元分配的地址空间，只允许给内存单元使用。其特点是内存的指令可以全部用于接口，不区分内存指令和接口指令，缺点是整个地址空间被分为两部分，内存地址不连续。
- **独立编址方法**：内存地址和接口地址是两个完全独立和相互隔离的地址空间。访问数据的指令也不同，接口只有读写指令，其余都是内存指令。特点是接口和内存指令容易区分，缺点是接口指令太少、功能过于单一。

## 输入输出指令

在计算机系统中，所有的输入输出操作都需要通过访存指令来完成。

## CPU 和外设的接口

CPU 与外设之间的数据交换必须通过接口完成，这些 I/O设备接口具有以下功能：

1. 设置数据存储和缓冲逻辑，以适应 CPU 与外设的速度差。
2. 能够转换信息格式，如串行和并行转换。
3. 能够协调 CPU 与外设之间的信息类型和电平差，如电平转换驱动器、数模或数模转换器等。
4. 协调时差。
5. 地址译码和设备选择功能。
6. 设置中断和 DMA 控制逻辑，确保在允许中断和 DMA 时产生中断和 DMA 请求信号，并在接收到中断和 DMA 响应后完成中断处理和 DMA 传输。

## CPU 和外设的数据传送方式

- **无条件传送方法（CPU与外设同步工作）**：外部控制过程各种动作时间是固定的，而且是已知的。在 CPU 与外设进行数据传送时，外设保证处于已准备好的状态。开关就是最典型的例子，无论什么时候开关肯定处于准备好的情况。
- **查询控制方法（CPU与外设不同步工作）**：CPU 通过程序主动读取状态寄存器，了解接口情况，完成相应的数据操作。由于查询操作需要以较少的时钟周期间隔重复，因此此方法的 CPU 效率较低。传送前，先查询外设状态，准备好才传送，否则 CPU 处于等待状态。
- **中断方式**：外设与 CPU 处于并行工作，一旦外设准备好，外设向 CPU 发中断申请，条件具备，CPU 暂停原程序执行，响应中断，外设与 CPU 串行工作。该方法具有较高的效率和良好的实时性。
- **DMA方式/直接存取器存取（高速I/O及成组交换数据）**：在计算机外部设备和主存之间直接传送而不是由 CPU 执行程序指令进行数据传送。数据在内存与 I/O设备间传送一个数据块的过程中，不需要 CPU 的任何干涉，只需要 CPU 在过程开始启动（即向设备发出传送—块数据的命令）与过程结束（CPU 通过轮询或中断得知过程是否结束和下次操作是否准备就绪）时的处理。实际操作由 DMA 硬件直接执行完成，CPU 在此传送过程中做别的事情，**CPU 在一个总线周期结束时响应 DMA** 。

## 中断

中断是指在计算机执行程序的过程中，当出现异常情况或者特殊请求时，计算机停止现行的程序的运行，转而对这些异常处理或者特殊请求的处理，处理结束后再返回到现行程序的中断处，继续执行原程序。

- **中断向量**：中断服务程序的入口地址值，CPU 一般从中断号中获取。
- **中断向量表**：把系统中所有的中断类型码及对应的中断向量按一定的规律存放在一个区域内，这个存储区域就称为中断向量表。

## 数据的表示

各种数据在计算机中表示的形式称为机器数，其特点是采用二进制计数制，数的符号用 0、1 表示，小数点隐含表示不占位置。

所有数据都是以位（比特 bit）为单位在计算机中进行传递，一个位就代表一个 0 或 1，每 8 个位组成一个字节（byte）。一个英文字母占用一个字节，一个汉字占用两个字节，一般位简写为小写字母 b，字节简写为大写字母 B。

## 定点数与浮点数

- **定点数**：约定所有数值数据的小数点隐含在某一个固定位置上，全称为定点表示法。当机器字长为 n 时，定点数的补码和移码可表示 $2^n$ 个数，而其原码和反码只能表示 $2^{n-1}$ 个数（ 0 占用了两个编码），因此，定点数所能表示的数值范围比较小，运算中很容易因结果超出范围而溢出。示例：0.1，1.0
- **浮点数**：约定一个数的小数点位置不是固定的，是可以浮动，全称为浮点表示法。浮点表示形式为：$N=E^q*F$，其中 E 称为阶码，F 为尾数，q 为精度。阶码通常为带符号的纯整数，尾数为带符号的纯小数，精度表示使用多少位来存储。浮点数所能表示的数值范围主要由阶码决定，所表示数值的精度则由尾数决定。示例：$1 * 10^{10}$，$0.1 * 10^{11}$

无论是定点表示法还是浮点表示法的小数点，在计算机处理中都不占用二进制存储位。

## 原码 反码 补码

- **原码**：最高位为符号位，0 表示正数，1 表示负数，优点是直观，缺点在负数计算时会出现错误。表示范围是 -127 到 127。
- **反码**：正数的反码是自身，负数的反码符号位不变，数值部分按位求反。例如原码 10110100B，则反码为 11001011B。表示范围是 -127 到 127。
- **补码**：正数的补码是自身，负数的补码符号位不变，数值部分按位求反，然后整个数加 1。例如原码 10110100B，则补码为 11001100B。补码的作用是使得符号位和有效值部分一起参加运算，将减法运算转换为加法运算。补码的表示范围是 -128 到 127。
- **移码（增码）**：符号位取反的补码，一般用作浮点数的阶码，作用是为了保证浮点数的机器零全 0，有利于机器中判 0 电路的实现。

![](/images/drawingbed/img/202306271934196.png)

## 溢出

当两个同符号的数相加或相异符号数相减时，运算结果可能产生溢出。

比如，设符号位使用 0 来表示正数，1 表示负数。有计算 0110(+6) + 0100(+4) = 1010(-2)，显然这里发生溢出，正确答案应为 01010(+10)。

为了解决溢出，常见的检测机制有以下两种：

- **进位判决法**：当 C(n-1) 位表示最高数值位向最高位进位，C(n) 表示符号位的进位，则 C(n-1)⊕C(n)=1，异或结果为真时表示溢出。比如：0110(+6) + 0100(+4)，最高数值位相加进 1，符号位相加不进为 0，则 1⊕0=1，发生溢出。
- **双符号位判决法**：采用双符号位，00 表示正号，11 表示负号。如果进位将会导致符号位不一致，从而检测出溢出。因此，对结果符号位进行**异或运算**，结果的符号位为 01 时，称为上溢（正溢出）；为 10 时，称为下溢（负溢出）。比如：00110(+6) + 00100(+4)，相加结果为 01010，则符号位 01 异或运算 0⊕1=1，发生溢出，出现上溢。

## 流水线

- **流水线的优势**：
  - 流水线使得指令能在一个 CPU 时钟周期内完成。
  - 流水线前一个子过程为下一个子过程创造执行条件，每一个过程可以与其他子过程同时进行，提高效率。
- **流水线的周期**：流水线各段执行时间最长的一段为整个流水线的瓶颈，一般将其执行时间称为流水线的周期。
- **流水线的总耗时**：单条指令所需时间 +（n-1）X（流水线周期），n 为指令数量。
- **流水线的吞吐率**：单位时间内流水线所完成的任务数量或输出的结果数量，基本公式为：TP = n / T，指令数量 / 总耗时。

## 流水线的计算（单缓冲区与双缓冲区）

- 在块设备输入数据的过程中，首先把磁盘数据送到缓冲区，花费的时间为 Ts
- 然后把操作系统缓冲区的数据送到用户区，花费的时间为 Tm
- 最后用户进程对这批数据进行计算，花费的时间为 Tc

**在单缓冲区时**，上述操作中每个数据都要经过【读入缓冲区，送用户区，处理】这三个步骤。在三个步骤中，读入缓冲区和送用户区都需要使用缓冲区，且这两个步骤执行时，缓冲区都不能进行其他操作。因此，可以将这个两个步骤看作一个操作【读入缓冲区并送用户区】，即每个数据都经过（最终流水线）【读入缓冲区并送用户区，处理】两个操作。运用流水线的方式计算耗时有：（Ts+Tm+Tc）+ (n-1) X (Max((Ts+Tm),Tc))

**在双缓冲区时**，上述操作中每个数据都要经过【读入缓冲区，送用户区，处理】这三个步骤。在三个步骤中，读入缓冲区和送用户区都需要使用缓冲区，且这两个步骤执行时，缓冲区都不能进行其他操作。但由于使用了双缓冲区，读入缓冲区和送用户区操作可以并行。假设有AB两个缓冲区，第一个数据读入缓冲区A后，送用户区从A中取出数据，同时第二个数据可以读入缓冲区B，然后用户在A取完数据后可以从B取，使用并行操作。因此每个数据都经过（最终流水线）【读入缓冲区，送用户区，处理】三个操作。运用流水线的方式计算耗时有：（Ts+Tm+Tc）+ (n-1) X (Max(Ts,Tm,Tc))

## 计算机的体系结构分类

根据指令和数据流的概念对计算机的体系结构分类，可分为以下 4 种类别：

- **单指令流单数据流 SISD**：同一时刻内，只有一个控制流，一个数据流，即只能单独执行一条指令，并处理一条数据。
- **多指令流单数据流 MISD**：具有多个处理单元，按多条指令的要求对同一个数据流进行处理。
- **单指令流多数据流 SIMD**：能以并行同步的方式在同一时间内执行同一条指令，同时可以处理多个数据。
- **多指令流多数据流 MIMD**：多个处理单元根据不同的控制流程处理不同的多个数据。

## RISC 精简指令集

1. 采用超标量和超流水线结构，具有极高的并行能力。
2. 由于是精简指令集，所以流水线以及常用的指令都可以使用硬件执行。
3. 采用大量寄存器，使得大部分操作都在寄存器中进行，提高了执行速度。
4. 采用了缓存—主机—外存三级存储结构，使得取数和存数指令分开执行，提高了处理器的性能。

## CISC 复杂指令集

1. 由于 CISC 指令集比较丰富，因此有效的减少编译代码中指令的数量，使得取指操作所需要的内存访问数量达到最小化。
2. 由于编译代码的减少，编译器结构的结构也可以得到简化，减少程序设计语言与机器语言间的语义差别。
3. CISC 指令集很难执行指令流水操作，且指令的时钟周期会比较长，使用起来并不高效。

## RISC 与 CISC 的对比

- **指令系统**：RISC 的指令主要集中于经常使用的指令上，不常用的指令通过组合指令来完成。因此在 RISC 上实现特殊功能时效率较低，但可以通过流水和超标量技术加以改进。而 CISC 的指令系统比较丰富，具有许多专用指令来完成特定功能。
- **存储器操作**：RISC 对存储器操作有限制，控制简单化。CISC的存储器指令多，操作直接。
- **程序**：RISC 汇编语言程序一般需要较大内存空间，实现特殊功能时程序复杂，不易设计；CISC 汇编语言程序变成相对简单，设计相对容易，效率较高。
- **中断**：RISC 机器在任意指令的适当地方都可以响应中断；而 CISC 则只能在指令结束后响应中断。
- **CPU**：RISC 面积小，功耗低；CISC 则功能强，面积大，功耗大。
- **设计周期**：RISC 结构简单，布局紧凑，设计周期短，易于采用新技术；CISC 结构复杂，设计周期长。
- **用户使用**：RISC 易学，CISC 复杂。

## 串联系统的故障率

- 串联系统的故障率等于串联的每个元件的故障率乘积。
- 平均故障间隔时间等于故障率乘积的倒数。

## CRC 循环冗余检验码

循环冗余校验码（CRC），简称循环码，是一种常用的、具有检错、纠错能力的校验码，在早期的通信中运用广泛。循环冗余校验码常用于外存储器和计算机同步通信的数据校验。不同于奇偶校验码和海明校验码都是采用奇偶检测为手段检错和纠错的(奇偶校验码不具有纠错能力)，循环冗余校验是通过某种数学运算来建立数据位和校验位的约定关系的。

循环冗余校验码由信息码 n 位和校验码 k 位构成。k 位校验位拼接在 n 位数据位后面，n+k 为循环冗余校验码的字长。

在计算校验码时，通常采用模 2 除法。n 位信息位可以表示为一个报文多项式 $f(x)$，最高幂次是 $x^{n-1}$。约定的生成多项式 $G(x)$ 是一个 $k+1$ 位的二进制数，最高幂次是 $x^k$。将 $f(x)$ 乘以 $x^k$，即左移 k 位后，再使用模2除法除以 $G(x)$，得到的 $k$ 位余数就是校验位。（模 2 除法：即当部分余数首位是1时商取1，反之商取0。然后每一位的减法运算是按位减，不产生借位。）

CRC码在存储或传送后，接收方使用生成多项式进行校验纠错。一个CRC码一定能被生成多项式整除，所以在接收方对码字用同样的生成多项式相除，如果余数为0，则码字没有错误；若余数不为0，则说明某位出错，不同的出错位置余数不同。在生成多项式确定时，出错位置和余数的对应关系是确定的。

实际的 CRC 校验码生成是采用二进制的模 2 算法（即减法不借位、加法不进位）计算出来的，这是一种异或操作（不同是为真，相同为假）。下面通过一些例子来进一步解释CRC的基本工作原理。

- 设约定的生成多项式为 $G(x)=x^4+x+1$，其二进制表示（ x=2 时）为 10011，共 5 位，其中 k=4。
- 假设要发送数据序列的二进制为 101011（ $f(x)$ ），共 6 位。
- 首先在要发送的数据后面加 4 个 0（ $f(x)*x^k$ )，二进制表示为 101011-0000，共 10 位。
- 用生成多项式的二进制表示 10011 去除乘积 101011-0000（ $1010110000\over 10011$ ），按模2算法求得余数比特序列为 0100（注意余数一定是k位的）。
- 将余数添加到要发送的数据后面，得到真正要发送的数据的比特流：101011-0100，其中前 6 位为原始数据，后 4 位为 CRC 校验码。
- 接收端在接收到带 CRC 校验码的数据后，如果数据在传输过程中没有出错，将一定能够被相同的生成多项式 $G(x)$ 除尽，如果数据在传输中出现错误，生成多项式 $G(x)$ 去除后得到的结果肯定不为0。

## 模 2 除法示例

![](/images/drawingbed/img/202306271935578.png)

## 其他校验码

- **奇偶校验码**：1 的个数为奇数则称为奇校验，1 的个数为偶数则称为偶校验。
- **CRC**：模 2 除，数据位 + 校验位，仅可检错。
- **海明码**：可检错也可纠错，但数据位与校验位需要满足一定位置关系。

## 计算机基本工作原理

- **初始化 PC**：由程序计数器 PC 指定指令在存储器的位置。
- **送地址**：PC > MAR，将 PC 第一条地址送入存储器地址寄存器 MAR。
- **取指令**：根据地址，从存储器或高速缓冲存储器中检索指令（为数值或一系列数值）放到指令寄存器 IR 。
- **指令解码**：通过控制器的译码，将指令拆解为有意义的片段。
- **执行指令**：连接到各种能够进行所需运算的 CPU 部件，执行指令。
- **写回**：将结果写入数据寄存器 MDR。
- **更新 PC**：根据指令代码和分支标志，从前面步骤得出的结果，生成下一条指令的地址放到 PC 里。

---
title: 01计算机系统构成及硬件基础知识
date: 2023-04-10
author: LM
---

# 2.计算机的组成

## 2.1 冯·诺伊曼型计算机

- 冯·诺伊曼型计算机是以存储程序控制为概念的一种计算机模型。
- 存储程序控制是指程序和数据事先存放在存储器中，当启动工作时，再自动高速的从存储器中取出并执行。
- 冯·诺伊曼型计算机由运算器，控制器，存储器，输入装置，输出装置 5 大基本部件组成。

## 2.2 硬件和软件

- 一个完整的计算机系统由硬件系统和软件系统两部分组成。
- 硬件是计算机的实体，是计算机实现其功能的物质基础。
- 软件是指挥计算机运行的程序集，如操作系统，网络系统等都属于软件，没有安装任何软件的计算机称为裸机。

## 2.3 计算机三大核心部件

- CPU、存储器、输入 / 输出设备（ I/O 设备 ）
- 上述三种组件由总线进行连接。

# 3.CPU 中的相关组件

## 3.1 CPU 的组成

- CPU 硬件上主要由运算器和控制器，以及用于存储数据的存储器和传输数据的总线组成。
- CPU 逻辑上由控制单元、运算单元和存储单元组成，这三部分由 CPU 内部总线进行连接。

## 3.2 运算器

- **算术逻辑单元 ALU**：CPU 的执行单元，同时也是 CPU 的核心组成部分，一个由与门和或门构成的算术逻辑单元。其主要功能是进行整数的二位元的算术运算，如加减乘(不包括整数除法)。
- **累加器 AC**：当运算器的算术逻辑单元执行算术或逻辑运算时，为 ALU 提供一个工作区，暂时存放运算结果信息。
- **数据缓冲寄存器 DR**：作为 CPU 和内存及外部设备间信息传送的中转站，用来暂时存放由内存读出或准备存入的指令或数据。
- **状态寄存器 PSW**：保存由算术指令和逻辑指令运行结果所建立的各种条件码内容，如运算结果的进位标志、溢出标志，为零标志、为负标志等。
- **通用寄存器组**：用于传送和暂存数据，也可参与算术逻辑运算，并保存运算结果。通用寄存器的长度取决于机器字长。

## 3.3 控制器

- **程序计数器 PC**：又称指令计数器，其总是保持将要执行的下一条指令的地址。在程序开始执行前，必须将它的起始地址，即程序第一条指令所在的内存地址送入 PC。大部分情况下，所有指令的地址码都需要先送入 PC，**程序员通过访问 PC 来控制程序执行过程**。
- **指令寄存器 IR**：用来保存当前正在执行的指令，**其位数取决于指令的长度**。当执行一条指令时，CPU 需要先把它从内存取到数据缓冲寄存器，然后再传送到指令寄存器。**指令寄存器对用户来说是完全透明的**，用户可以随时检查当前执行的指令。
- **指令译码器 ID**：分析和执行当前指令的部件。为了执行给定的指令，必须对操作码进行测试，以便识别所要求的操作。操作码一经译码后，即可向操作控制器发出具体的操作的信号。
- **操作控制器 OC**：根据指令操作码和时序信号，产生各种操作控制信号，以便正确地建立数据通路，从而完成取指令和执行指令的控制。CPU 内的每个部件间需要 OC 来控制信息传输，完成诸如信息从什么地方开始发送，中间经过哪个寄存器，最后传到哪个寄存器等操作。
- **时序节拍发生器**：CPU 中的一个时钟设备，使计算机可以准确、迅速、有条不紊地工作。操作控制器利用定时脉冲的顺序和不同的脉冲间隔，有条理、有节奏地指挥机器的动作，规定在这个脉冲到来时做什么，在那个脉冲到来时又做什么，给计算机各部分提供工作所需的时间标志。

## 3.4 存储器

- **寄存器组**：CPU 中暂时存放数据的地方，里面保存着那些等待处理的数据，或已经处理过的数据，CPU 访问寄存器所用的时间要比访问主存的时间短。采用寄存器组，可以减少 CPU 访问内存的次数，从而提高了 CPU 的工作速度。但因芯片面积和集成度所限，寄存器组的容量不可能很大。
- **高速缓冲存储器**：存在于主存与 CPU 之间的一级存储器，与主存间的信息传送通过硬件自动进行，容量比较小但速度比主存高得多，接近于 CPU 的速度，通常用来辅助寄存器组工作。

## 3.5 CPU 的多级时序系统

- **指令周期**：CPU 每取出并执行一条指令所需的全部时间叫指令周期。
- **机器周期/总线周期**：一般一条完整的指令包括：取指周期、间址周期、执行周期、中断周期。机器周期就是 CPU 指令执行过程中的一个基准事件。由于 CPU内部的操作速度较快，CPU 访存的操作时间较长，因此通常以访问一次存储器的时间定为机器周期。又由于不论执行什么指令，都需要访问存储器取出指令，因此在存储字长等于指令字长的前提下，取指周期也可看作机器周期。机器周期取决于指令的功能和器件的速度。
- **时钟周期/震荡周期**：在一个机器周期可完成若干个微操作，每个微操作需要一定的时间，可用时钟信号来控制每一个微操作命令。用时钟信号控制节拍发生器，就可产生节拍。每个节拍的宽度正好对应一个时钟周期。时钟周期是控制计算机操作的最小时间单位。
- 机器周期和节拍（状态）组成了多级时序系统。
- 一个指令周期包含若干个机器周期，一个机器周期包含若干个时钟周期。
- 一个指令周期包含的机器周期个数与指令所要求的动作有关，如单操作数指令，只需要一个取操作数周期，而双操作数指令需要两个取操作数周期。

## 3.6 CPU 基本工作原理

- **初始化 PC**：由程序计数器 PC 指定指令在存储器的位置。
- **送地址**：PC > MAR，将 PC 第一条地址送入存储器地址寄存器 MAR。
- **取指令**：根据地址，从存储器或高速缓冲存储器中检索指令（为数值或一系列数值）放到指令寄存器 IR 。
- **指令解码**：通过控制器的译码，将指令拆解为有意义的片段。
- **执行指令**：连接到各种能够进行所需运算的 CPU 部件，执行指令。
- **写回**：将结果写入数据寄存器 MDR。
- **更新 PC**：根据指令代码和分支标志，从前面步骤得出的结果，生成下一条指令的地址放到 PC 里。

# 4.总线

## 4.1 总线（Bus）

- 总线（Bus）是计算机CPU，内存，输入输出等部件间传递信息的共用通道，是由导线组成的传输线束，按功能和规范分为以下 3 种。
- **片总线（C-Bus）**：又称元件级总线，是各种不同的芯片连接通信的信息传输通路，通常出现在CPU内
- **内总线（I-Bus）**：又称系统总线和板级总线，是系统中各模块的信息传输通路，通常如CPU模块与存储器模块间的传输通路
- **外总线（E-Bus）**：又称通信总线，是计算机系统与系统外设备连接的信息传输通路
- 没有特殊说明，一般情况下，总线可以特指系统总线（内总线）。

## 4.2 系统总线（按功能分类）

- **数据总线 DB**：双向三态形式的总线。双向是指既可以把 CPU 的数据传出，也可以将其他部件的数据传入 CPU。CPU 与其他部件通过数据总线来交换数据。三态是指 -1，0，1。需要注意的是，数据总线的位数是微机的一个重要指标，数据总线宽度越大，单位时间内进出 CPU 的数据越多，系统运算速度越快。**数据总线位数通常与处理器的字长一致**。
- **地址总线 AB**：单向三态形式的总线。由于地址只能从 CPU 传向外部存储器，所以地址总线总是单向的。其位数决定 CPU 可以直接寻址的内存空间大小。若地址总线为 n 位，则寻址能力，即内存容量为 2^n，以字节为单位，则为 2^n B，**比如内存容量为 32GB ( 2^32 )的系统，其地址总线 32 位**。
- **控制总线 CB**：用来传送控制信号和时序信号。控制总线的传送方向由具体的控制信号而定，一般都是双向的。控制总线的位数根据系统 CPU 而定。

## 4.3 系统总线（按传输方式分类）

- **串行总线**：二进制数据逐位通过一条数据线进行传递。
- **并行总线**：数据线通常超过两根，并行传递数据。

## 4.4 系统总线（按时钟信号分类）

- **同步总线**：时钟信号独立于数据。
- **异步总线**：时钟信号从数据中获取。

## 4.5 总线复用

- 使用一条总线来实现多种功能，例如在不同时段中利用总线上同一信号线传输不同信号，采用这种方式来**减少总线中信号线的数量，提高总线的利用率**。

# 5.输入输出

## 5.1 输入输出接口（ I/O 接口）

- CPU 与外设之间的数据交换必须通过 I/O 接口完成。
- 接口能设置数据存储和缓冲逻辑，以适应 CPU 与外设的速度差。
- 接口能够转换信息格式，如串行和并行转换。
- 接口能够协调 CPU 与外设之间的信息类型和电平差，时差。
- 接口具备地址译码和设备选择功能。
- 接口能够设置中断和 DMA 控制逻辑，可以产生中断和 DMA 请求信号，并在接收到中断或 DMA 响应后完成中断处理和 DMA 传输。

## 5.2 CPU 和外设的数据传送方式

- **无条件传送（CPU与外设同步工作）**：外部控制过程各种动作时间是固定的，而且是已知的。在 CPU 与外设进行数据传送时，外设保证处于已准备好的状态。开关就是最典型的例子，无论什么时候开关肯定处于准备好的情况。
- **查询控制（CPU与外设不同步工作）**：CPU 通过程序主动读取状态寄存器，了解接口情况，完成相应的数据操作。由于查询操作需要以较少的时钟周期间隔重复，因此此方法的 CPU 效率较低。传送前，先查询外设状态，准备好才传送，否则 CPU 处于等待状态。
- **中断**：外设与 CPU 处于并行工作，一旦外设准备好，外设向 CPU 发出中断申请，CPU 暂停原程序执行，响应中断，外设与 CPU 串行工作。该方法具有较高的效率和良好的实时性。中断是指在计算机执行程序的过程中，当出现异常情况或者特殊请求时，计算机停止现行的程序的运行，转而对这些异常处理或者特殊请求的处理，处理结束后再返回到现行程序的中断处，继续执行原程序。
  - **中断向量**：中断服务程序的入口地址值，CPU 一般从中断号中获取。
  - **中断向量表**：把系统中所有的中断类型码及对应的中断向量按一定的规律存放在一个区域内，这个存储区域就称为中断向量表。
- **DMA / 直接存取器存取（高速 I/O 及成组交换数据）**：在计算机外部设备和主存之间直接传送而不是由 CPU 执行程序指令进行数据传送。数据在内存与 I/O设备间传送一个数据块的过程中，不需要 CPU 的任何干涉，只需要 CPU 在过程开始启动（即向设备发出传送—块数据的命令）与过程结束（CPU 通过轮询或中断得知过程是否结束和下次操作是否准备就绪）时的处理。实际操作由 DMA 硬件直接执行完成，CPU 在此传送过程中做别的事情，**CPU 在一个总线周期结束时响应 DMA** 。

## 5.3 内存与 I/O 接口的编址方式

- **统一编址方法**：内存地址和接口地址在一个公共的地址空间。其中一部分划给接口使用，其余地址给内存单元使用，内存单元分配的地址空间，只允许给内存单元使用。其特点是内存的指令可以全部用于接口，不区分内存指令和接口指令，缺点是整个地址空间被分为两部分，内存地址不连续。
- **独立编址方法**：内存地址和接口地址是两个完全独立和相互隔离的地址空间。访问数据的指令也不同，接口只有读写指令，其余都是内存指令。特点是接口和内存指令容易区分，缺点是接口指令太少、功能过于单一。

## 5.4 输入输出的指令

- 在计算机系统中，所有的输入输出操作都需要通过访存指令来完成。

# 6.存储器

## 6.1 存储器的类型（按存取方式）

- **随机存储器 RAM**：任何存储单元的内容都能被随机存取，且存取时间和存储单元的物理位置无关。
- **只读存储器 ROM**：存储的内容是固定不变的，只能读出而不能写入。
- **顺序存取存储器 SAM**：只能按某种顺序来存取，存取时间与存储单元的物理位置有关。
- **直接存取存储器 DMA**：数据可以不经过 CPU 的处理就直接在存储器或输入输出设备之间进行传输。
- **相联存储器**：不依靠地址，可以按照内容检索到存储位置进行读写。

## 6.2 存储器的类型（按作用）

- **主存储器（内存）**：用于存放活动的程序和数据，其速度高、容量较小、每位价位高。主存属于随机存取器。
- **辅助存储器（外存储器）**：主要用于存放不活跃的程序和数据，其速度慢、容量大、每位价位低。
- **缓冲存储器**：CPU 内的寄存器和 CPU 外的内存在进行数据交换时，作为缓冲使用。

## 6.3 存储器的类型（按速度）

- **CPU 内部寄存器**：寄存器是 CPU 内部用来存放数据的一些小型存储区域，用来暂时存放参与运算的数据和运算结果，拥有最快的存取速度。
- **高速缓存 Cache**：介于 CPU 和主存储器之间的高速小容量存储器。它和主存储器一起构成一级的存储器，容量比较小但速度比主存快，接近于 CPU 的速度。通常用来缓存一些常用数据，在程序运行时，Cache 和主存间的全部功能都由硬件自动完成。
- **内存储器**：用于存放 CPU 中的运算数据，以及与硬盘等外部存储器交换的数据，是外存与 CPU 进行沟通的桥梁。计算机中所有程序的运行都在内存中进行。
- **外存储器**：外储存器是指除计算机内存及 CPU 缓存以外的储存器，此类储存器一般断电后仍然能保存数据。常见的外存储器有硬盘、软盘、光盘、U 盘等。
- CPU 内部寄存器 > 高速缓存 Cache > 主存 > 大容量磁盘

## 6.4 虚拟存储器

- 虚拟存储器是在具有主存辅存层次结构存储器的计算机系统中，自动实现部分装入和部分替换功能，能从逻辑上为用户提供一个比物理存储容量大得多，并且可寻址的一个存储器。
- 虚拟存储区的容量与物理主存大小无关，而受限于计算机的地址结构和可用磁盘容量。
- 虚拟存储器的基本思路是：作业提交时，先全部进入辅助存储器，作业投入运行时，不把作业的全部信息同时装入主存储器，而是将其中当前使用部分先装入主存储器，其余暂时不用的部分先存放在作为主存扩充的辅助存储器中，待用到这些信息时，再由系统自动把它们装入到主存储器中。

# 7.外存（磁盘）

## 7.1 磁盘的作用

- 磁盘是计算机主要的存储介质，能比内存存储更多的二进制数据，且在断电后也能保持数据不丢失。

## 7.2 磁盘的组成

- **盘片**：一个磁盘由多个盘片叠加而成。
- **盘面**：盘片的表面涂有磁性物质，这些磁性物质用来记录二进制数据。盘片正反两面都可涂上磁性物质，因此一个盘片可能会有两个盘面。
- **磁道**：每个盘片被划分为一个个磁道（圆的周长）。
- **扇区**：每个磁道又划分为一个个扇区。其中，最内侧磁道上的扇区面积最小，因此数据密度最大（圆的面积）。
- **柱面**：每个盘面对应一个磁头。所有的磁头都是连在同一个磁臂上的，因此所有磁头只能共进退。所有盘面中相对位置相同的磁道组成柱面。

## 7.3 磁盘的容量计算

- 容量 C  = 扇区总数 x 每个扇区存储的字节数（物理块大小）

# 8.内存（RAM）

## 8.1 内存的作用

- 内存是计算机的重要部件，用于暂时存放 CPU 中的运算数据，以及与硬盘等外部存储器交换的数据，是外存与 CPU 进行沟通的桥梁。
- 内存结构上为随机存储器 RAM。
- 计算机中所有程序的运行都在内存中进行，只要计算机开始运行，操作系统就会把需要运算的数据从内存调到 CPU 中进行运算，当运算完成，再由 CPU 将结果传送出来，内存性能的强弱影响计算机整体发挥的水平。

## 8.2 内存的组成

- 内存由多个内存芯片、SPD 芯片（串行存在检测芯片）、少量电阻以及 PCB 板（印制电路板）组成。
- 内存的存储容量由内存芯片的个数和单个芯片的容量决定。

## 8.3 内存容量的计算

问题：内存按字节编址从 A5000H 到 DCFFFH，计算内存容量？

解：DCFFF - A5000 + 1=38000H，将 38000H 换算为二进制为：11 1000 00-00 0000 0000 = 1110 0000  X 2^10 = 224 KB，即内存容量224KB。

PS：16 进制计算中，可将 A 看作 10，B 看作 11，C 看作 12，以此类推，逐位计算。2 进制计算中，1-00 0000 0000 = 1 X 2^10 = 1 KB，10 个 0 等于 2^10。

## 8.4 内存芯片数量的计算

问题：内存按字节编址，地址为 0B4000H 至 0DBFFFH，若用存储容量为 32K * 8bit 的存储器芯片构成内存，至少需要多少片？

解：首先由 0DBFFFH - 0B4000H + 1 算得内存容量为 028000H B，即 160 KB。然后由于单个内存芯片容量为 32 KB（8bit = 1B），因此需要内存芯片个数 160 / 32 = 5，即该内存条由 5 个 32 KB 的内存芯片构成。

## 8.5 内存地址的计算

问题：如果主存容量为 16MB 字节，且按字节编址，则表示该主存地址至少需要多少位。

解：由于主存地址位数 = 主存容量（2^n）的幂 = n，因此主存容量 16 MB = 16 * 1024 * 1024 b = 2^(4+10+10) = 2^24，主存地址至少需要 24 位。

## 8.6 内存地址中区号，组号的计算

问题：容量为 64 块的 Cache 采用组相联方式映像，字块大小为 128 个字，每 4 块为一组。若主存容量为 4096 块，且以字编址，那么主存地址应为多少位，主存区号应为多少位。

解：由于主存地址位数 = 区号 + 组号 + 组内块号（每组字块数量 2^y 的幂 y） + 块内地址号（字块容量 2^x 的幂 x），因此字块大小为 128 (2^7) ，则块内地址号：7，每 4 (2^2) 块一组，则组内块号：2，Cache 容量为 64 块，每 4 块一组，则可以分为 16 (2^4) 组，则组号：4，主存容量 4096 * 128 = 2^19，则主存地址 19 位，区号 = 19-4-2-7 = 6。

## 8.7 高位存储芯片的合成

- 在存储器（如寄存器，内存）中，容量的最小单位是位 bit，只能存放一位二进制数，即 0 或 1。而常用的容量单位是字节 Byte，8个 bit 为一个字节 B。容量一般用 KB，MB，GB 来表示，它们之间的关系相差 1024 倍。一个存储器通常由多个芯片组成。
- 芯片的容量通常使用 1K X 8 位 这样的格式来表示，1K X 8 位 表示这个芯片的位数是 8 位( 可连接 8 位地址线 ) ，长度是 1K，容量是 8Kb。又比如，2K X 4位 的芯片宽度是 4 位，长度是 2K，那么容量就是 8Kb，按字节计算就是 1KB。
- 有时会使用多个低位的芯片组成一个高位存储器，比如使用多个 2K X 4位 的芯片组成一个 16K X 8 位的存储器。此时，通常需要将两片 2K X 4 位 的并联成一个 2K X 8 位的矩阵组，使得位数满足后，再计算需要芯片组 16K / 2K = 8 组，最后得到总共需要的芯片数 2 X 8 = 16 个。若从地址单元从 0000H 开始，则第一个 2K = 2^11  = 0800H 芯片的地址范围是 0000H 至 07FFH，第二个是 0800H 到 0FFFH ......

# 9.寻址方式

## 9.1 立即数寻址

- 一种特殊的寻址方式，获取操作数最快的寻址方式。
- 操作数直接存放到指令中，紧跟操作码之后，只要取出指令就可以立即使用操作数，如 MOV  AX，2435H。
- 立即寻址主要执行取指令访存1次，不需要执行指令访存，一共访存1次。

## 9.2 直接寻址

- 指令给出的形式地址就是操作数的有效地址，如 MOV  AX，[2000H]。
- 直接寻址主要执行取指令访存1次，还有执行指令访存1次，一共访存2次。

## 9.3 间接寻址

- 指令中地址码字段给的是操作数有效地址所在存储单元的地址，如 MOV  AX，[2000H]，这里的地址 [2000H] 指向操作数地址所在存储单元的地址。
- 间接寻址执行取指令访存1次，还要执行指令访存2次，一共访存3次。

## 9.4 寄存器寻址

- 操作数存放在 CPU 的某一通用寄存器中，可在指令中指出寄存器名调用操作数，如 MOV  AX，BX。
- 寄存器寻址主要执行取指令访存1次，由于访问的是寄存器因此不需要执行指令访存，一共访存1次。
- 访问寄存器会比访问主存快得多，但是寄存器数量也较少。

## 9.5 寄存器间接寻址

- 操作数的地址存放在寄存器，如 MOV  AX，[BX]。
- 寄存器间接寻址主要执行取指令访存1次，还有一次是寄存器执行指令访存1次，一共访存2次。

## 9.6 相对基址寻址

- 将指定寄存器的内容，加上指令中给出的位移量，并以一个段寄存器为基准作为操作数的有效地址，如 MOV  AX，COUNT + [SI]。
- 基址寻址最大的优点就在于可以扩大寻址范围。比如原先寻址的范围只有 0 到 4，用了基址寻址的方式，我们可以给其加一个基地址100，那么就可以在（100104）这个范围内再存取。

## 9.7 相对变址寻址

- 把基址寄存器 BX 和 BP 的内容加上变址寄存器 SI 和 DI 的内容作为操作数的有效地址，如 MOV  AX，[BX] + [DI]。
- 变址寻址常用在一些有规律的操作上，比如遍历字符串，遍历数组，通过修改变址值来取不同的操作数。

## 9.8 相对基址变址寻址

- 在变址寻址的基础上增加一个位移量，如 MOV  AX，MASK + [BX] + [SI]。
- 在相对基址变址寻址方式中，通常把 BX 和 BP 看作是基址寄存器，把 SI 和 DI 看作变址寄存器。它是把一个基址寄存器 BX 或 BP 的内容，加上变址寄存器SI 或 DI 的内容，再加上指令中给定的 8 位或 16 位位移量，并以一个段寄存器作为地址基准，作为操作数的地址。

## 9.9 寻址能力（空间）

- 一般来说，地址总线决定寻址能力，若地址总线为 n 位，则寻址能力为 2^n，以字节为单位，则为 2^n B。
- 例如：地址总线宽度为 24 位，则其寻址空间为 2^24 = 2^4 MB = 16 MB

